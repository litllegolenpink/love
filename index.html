<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>爱心烟花 - 苹果手机专属</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            height: 100vh;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #fff;
            padding: 20px;
            position: relative;
        }
        
        .ios-notch {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: env(safe-area-inset-top);
            background: rgba(0, 0, 0, 0.3);
            z-index: 1000;
        }
        
        .ios-home-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: env(safe-area-inset-bottom);
            z-index: 1000;
        }
        
        canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        
        .container {
            text-align: center;
            z-index: 10;
            padding: 30px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 24px;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow: 0 0 40px rgba(255, 105, 180, 0.5);
            max-width: 90%;
            width: 100%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: env(safe-area-inset-top);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 20px;
            color: #ff69b4;
            text-shadow: 0 0 15px rgba(255, 105, 180, 0.7);
            font-weight: 700;
            letter-spacing: 1px;
        }
        
        .subtitle {
            font-size: 1.3rem;
            margin-bottom: 30px;
            color: #f8f8f8;
            line-height: 1.6;
        }
        
        .heart-icon {
            font-size: 5rem;
            color: #ff69b4;
            animation: heartbeat 1.5s infinite;
            margin: 30px 0;
            text-shadow: 0 0 20px rgba(255, 105, 180, 0.8);
        }
        
        .message {
            font-size: 1.1rem;
            margin-top: 30px;
            color: #e0e0ff;
            line-height: 1.8;
            background: rgba(255, 105, 180, 0.15);
            padding: 20px;
            border-radius: 18px;
        }
        
        .instructions {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            padding: 0 20px;
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            z-index: 20;
        }
        
        .ios-button {
            display: inline-block;
            background: linear-gradient(to right, #ff69b4, #ff1493);
            color: white;
            padding: 14px 28px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            margin-top: 20px;
            text-decoration: none;
            box-shadow: 0 4px 20px rgba(255, 105, 180, 0.4);
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .ios-button:active {
            transform: scale(0.96);
            box-shadow: 0 2px 10px rgba(255, 105, 180, 0.4);
        }
        
        @keyframes heartbeat {
            0% { transform: scale(1); }
            5% { transform: scale(1.1); }
            10% { transform: scale(1); }
            15% { transform: scale(1.15); }
            20% { transform: scale(1); }
            100% { transform: scale(1); }
        }
        
        @media (max-width: 768px) {
            h1 { font-size: 2.2rem; }
            .subtitle { font-size: 1.1rem; }
            .message { font-size: 1rem; }
            .heart-icon { font-size: 4rem; }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 20px 15px;
            }
            h1 { font-size: 1.8rem; }
            .subtitle { font-size: 1rem; }
            .message { font-size: 0.9rem; padding: 15px; }
            .heart-icon { font-size: 3.5rem; margin: 20px 0; }
        }
    </style>
</head>
<body>
    <div class="ios-notch"></div>
    <canvas id="fireworks"></canvas>
    
    <div class="container">
        <h1>爱心烟花绽放</h1>
        <div class="subtitle">专为苹果手机优化的浪漫效果</div>
        <div class="heart-icon">❤</div>
        <div class="message">
            爱是宇宙中最美的烟花，即使短暂绽放，也能照亮整个夜空。<br>
            点击屏幕任意位置或按下按钮，让爱心在指尖绽放！
        </div>
        <button class="ios-button" id="triggerBtn">
            <i class="fas fa-heart"></i> 绽放爱心
        </button>
    </div>
    
    <div class="ios-home-bar"></div>
    <div class="instructions">轻触屏幕任意位置创建更多爱心烟花</div>

    <script>
        // 获取Canvas元素并设置尺寸
        const canvas = document.getElementById('fireworks');
        const ctx = canvas.getContext('2d');
        
        // 设置Canvas尺寸为窗口大小
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        
        // 初始化Canvas尺寸
        resizeCanvas();
        
        // 粒子数组
        const particles = [];
        const heartParticles = [];
        
        // 粒子类
        class Particle {
            constructor(x, y, color, size, velocity, life) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.size = size;
                this.velocity = velocity;
                this.life = life;
                this.alpha = 1;
                this.gravity = 0.05;
                this.friction = 0.97;
            }
            
            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.restore();
            }
            
            update() {
                this.velocity.x *= this.friction;
                this.velocity.y *= this.friction;
                this.velocity.y += this.gravity;
                this.x += this.velocity.x;
                this.y += this.velocity.y;
                this.life -= 0.01;
                this.alpha = this.life;
                
                return this.life > 0;
            }
        }
        
        // 爱心类
        class HeartParticle extends Particle {
            constructor(x, y, color, size, velocity, life) {
                super(x, y, color, size, velocity, life);
                this.rotation = Math.random() * Math.PI * 2;
                this.rotationSpeed = (Math.random() - 0.5) * 0.1;
            }
            
            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation);
                const scale = this.size / 15;
                ctx.scale(scale, scale);
                
                // 绘制爱心
                ctx.fillStyle = this.color;
                ctx.beginPath();
                for (let angle = 0; angle < Math.PI * 2; angle += 0.01) {
                    const r = 15 * (Math.sin(angle) * Math.sqrt(Math.abs(Math.cos(angle))) / (Math.sin(angle) + 7/5) - 2 * Math.sin(angle) + 2;
                    const x = r * Math.cos(angle);
                    const y = -r * Math.sin(angle);
                    if (angle === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.closePath();
                ctx.fill();
                
                ctx.restore();
            }
            
            update() {
                this.rotation += this.rotationSpeed;
                return super.update();
            }
        }
        
        // 创建烟花爆炸
        function createFirework(x, y) {
            const particleCount = 150;
            const hue = 320 + Math.random() * 40; // 粉红色范围
            const color = `hsla(${hue}, 100%, 70%, 0.8)`;
            
            for (let i = 0; i < particleCount; i++) {
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 3 + 1;
                const velocity = {
                    x: Math.cos(angle) * speed,
                    y: Math.sin(angle) * speed
                };
                const size = Math.random() * 3 + 1;
                const life = Math.random() * 0.5 + 0.5;
                
                particles.push(new Particle(x, y, color, size, velocity, life));
            }
        }
        
        // 创建爱心粒子
        function createHeart(x, y) {
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 1.5 + 0.5;
                const velocity = {
                    x: Math.cos(angle) * speed,
                    y: Math.sin(angle) * speed
                };
                const size = Math.random() * 10 + 10;
                const life = Math.random() * 0.7 + 0.5;
                const hue = 320 + Math.random() * 40; // 粉红色范围
                const color = `hsla(${hue}, 100%, 70%, 0.8)`;
                
                heartParticles.push(new HeartParticle(x, y, color, size, velocity, life));
            }
        }
        
        // 动画循环
        function animate() {
            requestAnimationFrame(animate);
            ctx.fillStyle = 'rgba(10, 10, 30, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // 更新和绘制普通粒子
            for (let i = particles.length - 1; i >= 0; i--) {
                if (!particles[i].update()) {
                    particles.splice(i, 1);
                } else {
                    particles[i].draw();
                }
            }
            
            // 更新和绘制爱心粒子
            for (let i = heartParticles.length - 1; i >= 0; i--) {
                if (!heartParticles[i].update()) {
                    heartParticles.splice(i, 1);
                } else {
                    heartParticles[i].draw();
                }
            }
        }
        
        // 初始烟花效果
        setTimeout(() => {
            createFirework(canvas.width / 2, canvas.height / 2);
            setTimeout(() => createHeart(canvas.width / 2, canvas.height / 2), 500);
        }, 500);
        
        // 定期创建烟花
        setInterval(() => {
            if (Math.random() > 0.7) {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height * 0.5;
                createFirework(x, y);
                
                if (Math.random() > 0.5) {
                    setTimeout(() => createHeart(x, y), 500);
                }
            }
        }, 1500);
        
        // 处理窗口大小变化
        window.addEventListener('resize', () => {
            resizeCanvas();
        });
        
        // 点击屏幕创建烟花
        canvas.addEventListener('click', (e) => {
            createFirework(e.clientX, e.clientY);
            setTimeout(() => createHeart(e.clientX, e.clientY), 500);
        });
        
        // 触摸事件处理
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            createFirework(touch.clientX, touch.clientY);
            setTimeout(() => createHeart(touch.clientX, touch.clientY), 500);
        }, { passive: false });
        
        // 按钮事件
        document.getElementById('triggerBtn').addEventListener('click', () => {
            createFirework(canvas.width / 2, canvas.height / 2);
            setTimeout(() => createHeart(canvas.width / 2, canvas.height / 2), 500);
        });
        
        // 开始动画
        animate();
        
        // 添加iOS设备检测
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        if (isIOS) {
            document.body.classList.add('ios-device');
        }
    </script>
</body>
</html>
